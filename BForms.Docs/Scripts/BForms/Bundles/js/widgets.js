(function(a){if(typeof define==="function"&&define.amd){define("bforms-inlineQuestion",["jquery","bootstrap","jquery-ui-core","icanhaz"],a)}else{a(window.jQuery)}})(function(a){var b=function(c){this.options=a.extend(true,{},this.options,c)};b.prototype.options={template:'<p>{{question}}</p><hr />{{#buttons}}<button type="button" class="btn bs-popoverBtn {{cssClass}}"> {{text}} </button> {{/buttons}}',contentTemplate:'{{content}}<hr />{{#buttons}}<button type="button" class="btn bs-popoverBtn {{cssClass}}"> {{text}} </button> {{/buttons}}',placement:"left",content:undefined,closeOnOuterClick:true,};b.prototype._init=function(){this.$element=this.element;if(typeof ich.renderPopoverQuestion!=="function"){ich.addTemplate("renderPopoverQuestion",this.options.template)}if(typeof ich.renderPopoverContent!=="function"){ich.addTemplate("renderPopoverContent",this.options.contentTemplate)}this._addPopover()};b.prototype._delegateEvents=function(){this.$tip.on("click",".bs-popoverBtn",a.proxy(function(d){var f=this.$tip.find(".bs-popoverBtn").index(d.currentTarget),c=this.options.buttons[f];if(c!=null&&typeof c.callback==="function"){d.preventDefault();d.stopPropagation();c.callback.apply(this,arguments)}},this));if(this.options.closeOnOuterClick&&a(document).data("bsPopoverClickHandler")!==true){a(document).on("click",function(f){var d=a(f.target);var c=a(".bs-hasInlineQuestion").filter(function(i,h){var e=a(h),g=e.data("bs.popover").$tip;return g.is(":visible")&&e[0]!=d[0]&&e.find(d).length==0&&d[0]!=g[0]&&g.find(d).length==0});c.bsInlineQuestion("hide")}).data("bsPopoverClickHandler",true)}};b.prototype._addPopover=function(){this.$element.popover({html:true,placement:this.options.placement,content:this._renderPopover()}).addClass("bs-hasInlineQuestion");this.$element.on("show.bs.popover",function(){});this.$tip=this.$element.data("bs.popover").tip();this._delegateEvents()};b.prototype._renderPopover=function(){return typeof this.options.content==="undefined"?ich.renderPopoverQuestion(this.options,true):ich.renderPopoverContent(this.options,true)};b.prototype.hide=function(){this.$element.popover("hide")};b.prototype.show=function(){this.$element.popover("show")};b.prototype.toggle=function(){this.$element.popover("toggle")};a.widget("bforms.bsInlineQuestion",b.prototype)});define("bforms-sortable",["jquery","jquery-ui-core"],function(){var a=function(b){this.options={};$.extend(true,this.options,this._defaultOptions,b);this.init();this.$targetStack=[]};a.prototype._defaultOptions={selectors:{list:".bs-sortable",item:".bs-sortable-item",container:".sortable-container",placeholder:".placeholder",helper:".helper",trigger:".sortable-trigger"},classes:{helper:"helper",activePlaceholder:"placeholder-active",placeholder:"placeholder",trigger:"sortable-trigger",displacedLeft:"displaced-left",displacedRight:"displaced-right",noRightDisplacement:"no-right-displacement",noLeftDisplacement:"no-left-displacement"},display:{activePlaceholderHeight:30,inactivePlaceholderHeight:4,placeholderWidth:200,triggerWidth:200},draggable:{minimumDisplacementDistance:20,levelOffset:40,options:{}},droppable:{initialTolerance:"touch",activeTolerance:"touch",options:{}},snapEnabled:false,accept:function(b,c){var d=b.data("appends-to");if(d==null||!/\S/.test(d)){return false}var e=c.data("id");return d.indexOf(e)!==-1},serializationMode:"object",validateInDepth:true};a.prototype.serializationModes={object:"object",array:"array"};a.prototype.directions={left:-1,right:1};a.prototype.init=function(){$(this.options.selectors.item).each(function(f,d){$(d).data("_uid",f);$(d).attr("data-_uid",f)});this._createPlaceholders();var c={accept:this.options.selectors.item,tolerance:this.options.droppable.initialTolerance,over:$.proxy(this._evOnOverlap,this),out:$.proxy(this._evOnExit,this),greedy:true};$(this.options.selectors.placeholder).droppable(c);var b={drag:$.proxy(this._evOnDrag,this),start:$.proxy(this._evOnStart,this),stop:$.proxy(this._evOnStop,this),cursor:"move",helper:$.proxy(function(f){var g=$(f.currentTarget)[0].outerHTML;$(f.currentTarget).find(this.options.selectors.placeholder).droppable("option","accept",null);var d=$(g).data("_uid",$(f.currentTarget).data("_uid")).addClass("helper").css({height:"15px"});if(d.find(this.options.selectors.item).length!=0){d.find(this.options.selectors.list).remove()}return d},this)};if(this.options.snapEnabled){$.extend(true,b,{snap:this.options.selectors.item,snapTolerance:10,snapMode:"outer"})}$(this.options.selectors.item).draggable(b);this.options.draggable.options=b;this.options.droppable.options=c};a.prototype._createPlaceholders=function(){$(this.options.selectors.item).each($.proxy(function(c,b){$(b).after(this._placeholderHtmlFor($(b).data("_uid")))},this));$(this.options.selectors.list).each($.proxy(function(d,c){var b=$(c).children(this.options.selectors.item).first();b.before(this._placeholderHtmlFor($(c).data("_uid"),this.options.classes.noRightDisplacement))},this));$(this.options.selectors.list+":first").children(this.options.selectors.placeholder).addClass(this.options.classes.noLeftDisplacement);$(this.options.selectors.placeholder).each($.proxy(function(c,b){var d=this._getLevelFor($(b));$(b).data("data-_uid",$(b).attr("data-_uid"));$(b).data("offset",d);$(b).attr("data-offset",d)},this))};a.prototype._evOnDrag=function(b,c){};a.prototype._evOnStart=function(c,d){d.helper.addClass(this.options.classes.helper);var b=$(this.options.selectors.item+'[data-_uid="'+d.helper.data("_uid")+'"]:first');b.css("opacity",0.5);$(this.options.selectors.placeholder).css({height:"5px"});this.currentSource={ui:d,parent:$(c.target).parents(this.options.selectors.list+":first")};$(this.options.selectors.container).trigger({type:"drag-start",item:b})};a.prototype._evOnStop=function(c,d){d.helper.removeClass(this.options.classes.helper);this.$dropTarget=this.$targetStack.length!=0?this.$targetStack[0]:null;var f=false;if(this.$dropTarget!=null&&this._isValidMove(c,d)){this._dropDraggedElement(c,d);this.$targetStack=[];f=true}else{this._resetDraggedElement(c,d);this.$targetStack.splice(this.$targetStack.length-1,1)}var b=$(this.options.selectors.item+'[data-_uid="'+d.helper.data("_uid")+'"]');b.find(this.options.selectors.placeholder).droppable("option","accept",this.options.selectors.item);b.css("opacity",1);$(this.options.selectors.placeholder).animate({height:this.options.display.inactivePlaceholderHeight,"border-width":"0px"},{duration:100,complete:$.proxy(function(){if(f){$(this.options.selectors.container).trigger({type:"update",updatedList:this._serialize(this.options.serializationMode)});f=false}},this)})};a.prototype._evOnOverlap=function(c,d){this.$targetStack.push($(c.target));var b=this._getItem(d.helper.data("_uid"));var f=parseInt(b.find("span:first").css("width").replace("px",""))+parseInt(b.find("span:last").css("width").replace("px",""));$(c.target).css({height:this.options.display.activePlaceholderHeight,width:f,"background-color":"inherit","border-style":"dotted","border-color":"black","border-width":"1px"});this.helperInitialLeft=d.offset.left;this._toggleHorizontalChangeListening($(c.target),d.draggable,true);$(this.options.selectors.container).trigger({type:"over",item:b,placeholder:$(c.target)})};a.prototype._toggleHorizontalChangeListening=function(c,b,d){d=typeof d=="undefined"?true:d;if(d){b.on("drag",$.proxy(function(f,g){this._checkDepthChange(f,g)},this))}else{b.unbind("drag")}};a.prototype._evOnExit=function(b,c){this.$targetStack.splice(this.$targetStack.length-1,1);$(b.target).animate({height:this.options.display.inactivePlaceholderHeight,"border-width":"0px"},100);this._resetPlaceholderDisplacements();this._toggleHorizontalChangeListening($(b.target),c.draggable,false)};a.prototype._checkDepthChange=function(f,g){var d=Math.abs(g.offset.left-this.helperInitialLeft);var b=this.options.draggable.minimumDisplacementDistance;var c=g.offset.left-this.helperInitialLeft<=0?this.directions.left:this.directions.right;if(d>=b&&this.$targetStack.length!=0){this._changeDepth(f,g,c)}};a.prototype._changeDepth=function(g,l,d){var b=this.$targetStack[0];var i=parseInt(b.css("margin-left").replace("px",""));var c=this._getLevelFor(b);var j=this.options.draggable.levelOffset;if((-1)*c*this.options.draggable.levelOffset>i+d*j||i+d*j>this.options.draggable.levelOffset){this.helperInitialLeft=l.offset.left;return}if(typeof b!="undefined"&&b!=null){var h=(b.hasClass(this.options.classes.noLeftDisplacement)&&d==this.directions.left)||(b.hasClass(this.options.classes.noRightDisplacement)&&d==this.directions.right);if(h){this.helperInitialLeft=l.offset.left;return}b.css("margin-left",i+d*j+"px");var f=d==this.directions.left?this.options.classes.displacedLeft:this.options.classes.displacedRight;if(!b.hasClass(f)){b.addClass(f)}var k=parseInt(b.data("offset"));b.data("offset",k+d)}this.helperInitialLeft=l.offset.left};a.prototype._isValidMove=function(g,i){var b=i.helper;var f=this.$dropTarget;if(this.options.accept==null||typeof this.options.accept!="function"){return true}var c=f.data("_uid")!==b.data("_uid")?this._getItem(f.data("_uid")):f.siblings(this.options.selectors.item+":first");if(f.data("_uid")=="undefined"){c=f.parents(this.options.selectors.item+":first")}var h=this._elementsOnSameLevel(b,c,f);var j=this.options.accept(b,c);if(this.options.validateInDepth){var d=f.parents(this.options.selectors.item);var k=true;d.each($.proxy(function(l,e){if(!this.options.accept(b,$(e))){k=false}},this));if(!k){return false}}return h||j};a.prototype._resetDraggedElement=function(b,c){c.helper.css({top:0,left:0})};a.prototype._elementsOnSameLevel=function(b,e,d){if(d.hasClass(this.options.classes.displacedLeft)||d.hasClass(this.options.classes.displacedRight)){return false}var c=b.parents(this.options.selectors.list+":first");var f=e.parents(this.options.selectors.list+":first");return c.data("_uid")==f.data("_uid")};a.prototype._getLevelFor=function(b){return b.parents(this.options.selectors.item).length};a.prototype._countLevels=function(c){c=c||$(this.options.selectors.list+":first");var d=0;var b=c.children(this.options.selectors.item);if(b.length==0){return 0}b.each($.proxy(function(g,f){d=Math.max(d,this._countLevels($(f).children(this.options.selectors.list+":first")))},this));return d+1};a.prototype._dropDraggedElement=function(i,l){var h=this.$dropTarget;var b=$(this.options.selectors.item+'[data-_uid="'+l.helper.data("_uid")+'"]:first');var g=$(this.options.selectors.placeholder+'[data-_uid="'+b.data("_uid")+'"]');if(!h.hasClass(this.options.classes.displacedLeft)&&!h.hasClass(this.options.classes.displacedRight)){h.after(b)}else{var j=this._getLevelFor(h);if(h.hasClass(this.options.classes.displacedLeft)){var k=parseInt(h.data("offset"));var d=h.parents(this.options.selectors.item);var c=d[j-k-1];$(c).after(b)}else{var f=h.data("_uid")!==b.data("_uid")?this._getItem(h.data("_uid")):h.siblings(this.options.selectors.item+":first");f.children(this.options.selectors.list+":first").append(b)}this.depthChangeInProgress=false}this.depthChangeInProgress=false;this.helperInitialLeft=0;this._resetPlaceholderDisplacements();g.remove();this._insertPlaceholderAfter(b)};a.prototype._hideAllPlaceholders=function(b){$(this.options.selectors.placeholder).each(function(d,c){if(typeof b!=="undefined"&&b!=null&&$(c).data("_uid")===b){return}$(c).animate({height:"0","border-width":"0px"},100)})};a.prototype._resetPlaceholderDisplacements=function(){var b=$(this.options.selectors.placeholder);b.each($.proxy(function(f,d){var c=$(d);var g=this._getLevelFor(c);c.removeClass(this.options.classes.displacedLeft);c.removeClass(this.options.classes.displacedRight);c.data("offset",g);c.attr("data-offset",g);c.css("margin-left","0px")},this))};a.prototype._getActivePlaceholders=function(){var b=[];$(this.options.selectors.placeholder).each($.proxy(function(d,c){if($(c).css("height")==this.options.display.activePlaceholderHeight+"px"){b.push($(c))}},this));return b};a.prototype._togglePlaceholder=function(g,f){var c=this._getPlaceholder(g);var b=this._getItem(g);var e=f?this.options.display.activePlaceholderHeight:this.options.display.inactivePlaceholderHeight;var d=f?"2px":"0px";c.animate({height:e,width:b.css("width"),"background-color":"inherit","border-style":"dotted","border-color":"black","border-width":d},100);c.droppable({olerance:"pointer",over:$.proxy(this._evOnOverlap,this),out:$.proxy(this._evOnExit,this),accept:this.options.selectors.item})};a.prototype._getById=function(b,c){return $(b+'[data-_uid="'+c+'"]')};a.prototype._getPlaceholder=function(b){return this._getById(this.options.selectors.placeholder,b)};a.prototype._getTrigger=function(b){return this._getById(this.options.selectors.trigger,b)};a.prototype._getItem=function(b){return this._getById(this.options.selectors.item,b)};a.prototype._insertPlaceholderAfter=function(b){b.after('<div class="placeholder placeholder-active" data-_uid="'+b.data("_uid")+'"></div>');var c=$(this.options.selectors.placeholder+'[data-_uid="'+b.data("_uid")+'"]');c.data("_uid",b.data("_uid"));c.droppable(this.options.droppable.options)};a.prototype._placeholderHtmlFor=function(c,b){b=b||"";return'<div style="height: 4px;" class="placeholder '+b+'" data-_uid="'+c+'"></div>'};a.prototype._serialize=function(b){b=b||this.serializationModes.object;if(b===this.serializationModes.object){return this._serializeList($(this.options.selectors.container+" > "+this.options.selectors.list))}if(b===this.serializationModes.array){return this._serializeAsArray()}return this._serializeList($(this.options.selectors.container+" > "+this.options.selectors.list))};a.prototype._serializeList=function(c){var d=[];var b=c.children(this.options.selectors.item);b.each($.proxy(function(g,f){d.push({Id:$(f).data("id"),Name:$(f).children("span:last").text(),Order:this._getOrderFor($(f)),Children:this._serializeList($(f).children(this.options.selectors.list))})},this));return d.length!=0?d:null};a.prototype._serializeAsArray=function(){var b=$(this.options.selectors.container).find(this.options.selectors.item);var c=[];var d=$(this.options.selectors.container).data("parent-property");b.each($.proxy(function(g,f){var l=$(f).parents(this.options.selectors.item+":first").data("id");var k=this._getOrderFor($(f));var h=$(f).data("id");var j={Id:h,Order:k,Name:$(f).children("span:last").text()};j[d]=l;c.push(j)},this));return c};a.prototype._getOrderFor=function(b){var d=0;var c=b.parents(this.options.selectors.list+":first");c.children(this.options.selectors.item).each(function(g,f){if($(f).data("_uid")===b.data("_uid")){d=g;return}});return d};$.fn.extend({bsSortable:function(c){var d={selectors:{}};if(typeof c!=="undefined"&&c!=null){d.selectors.item=c.itemSelector;d.selectors.list=c.listSelector;d.selectors.container=c.containerSelector;d.accept=c.accept;d.snapEnabled=c.snapEnabled;d.serializationMode=c.serialize;d.validateInDepth=c.validateInDepth}var b=new a(d);this.data("bsSortable",b)}});return a});define("bforms-grid",["jquery","jquery-ui-core","bforms-pager","bforms-editable","bforms-panel","bforms-ajax","bforms-namespace","bforms-inlineQuestion"],function(){var a=function(b){this.options=$.extend(true,{},this.options,b);this._init()};a.prototype.options={$toolbar:$([]),gridItem:".bs-item",gridItemDetails:".bs-details",gridDetailsContainer:".bs-rowDetails",hasOrder:true,orderContainerSelector:".title",orderElemSelector:".bs-orderColumn",multipleOrder:false,defaultPage:1,currentPage:1,goTopElement:null,uniqueName:null,gridRowsHeaderSelector:".bs-header",gridContainerSelector:".grid_rows",gridCountContainerSelector:"h2 > .badge",gridHeaderSelector:"h2",filterSelector:".bs-filter",resetGridSelector:".bs-resetGrid",addSelector:".bs-triggerAdd",expandToggleSelector:".bs-toggleExpand",rowsContainerSelector:".grid_rows_wrapper",rowSelector:".grid_row",rowHeaderSelector:"header",rowDetailsSelector:".grid_row_details",rowActionsContainerSelector:".bs-row_controls",rowDetailsSuccessHandler:null,rowActions:[],updateRowUrl:null,hasRowCheck:true,rowCheckSelector:'.bs-row_check:not([disabled="disabled"])',headerCheckSelector:".check_all > input",groupActionsSelector:".bs-group_actions",pager:null,pagerUrl:null,onRefresh:null,detailsSelector:".bs-expand",detailsUrl:null,multipleDetails:true,removeDetailsOnCollapse:false,validationSummaryContainer:".bs-validation_summary",validationRowActionsContainer:".bs-validation_row_action",errorRowContainer:".bs-validation_row",errorCloseSelector:".bs-form-error .close",noResultsRowSelector:".bs-noResultsRow",sortable:true,rowClickExpandable:true,defaultFilterButtons:[{btnSelector:".js-all",filter:function(b){return true},},{btnSelector:".js-none",filter:function(b){return false},}]};a.prototype._refreshModel={OrderableColumns:[],Search:{},Page:1,PageSize:5,quickSearch:""};a.prototype._initialModel={PageSize:5};a.prototype._init=function(){if(!this.options.uniqueName){this.options.uniqueName=this.element.attr("id")}if(!this.options.uniqueName){throw"grid needs a unique name or the element on which it is aplied has to have an id attr"}this._initDefaultOptions();this._initSelectors();this.options.hasRowCheck=this.$actionsContainer.length>0;this.hasDetails=this.options.detailsSelector&&this.options.detailsUrl;this._addDelegates();this.refreshModel=$.extend(true,{},this._refreshModel,this.element.data("settings"));this.refreshModel.OrderColumns=this._getColumnsOrder();this._currentResultsCount=this.$gridCountContainer.text();this.$pager=this.element.find(".bs-pager").bsPager({pagerUpdate:$.proxy(this._evOnPageChange,this),pagerGoTop:$.proxy(this._evOnPagerGoTop,this)});this.refreshModel.PageSize=parseInt(this.$pager.bsPager("getPageSize"),10)||this.refreshModel.PageSize;this._initialModel.PageSize=this.refreshModel.PageSize;this.needsRefresh=false;if(this.options.sortable&&($.browser==null||$.browser.mobile==false)){this._initSortable()}this.$rowsContainer.find(this.options.rowSelector).each($.proxy(function(b,c){this._initInitialDetails($(c))},this))};a.prototype._initDefaultOptions=function(){if(typeof this.options.filterButtons!=="undefined"&&$.isArray(this.options.filterButtons)){this.options.filterButtons=this.options.filterButtons.concat(this.options.defaultFilterButtons)}else{this.options.filterButtons=this.options.defaultFilterButtons}};a.prototype._addDelegates=function(){if(this.hasDetails){this.element.on("click",this.options.detailsSelector,$.proxy(this._evOnDetailsClick,this));if(this.options.rowClickExpandable){this.element.on("click",this.options.rowSelector,$.proxy(this._onRowClick,this))}}if(this.options.hasOrder){this.element.on("click",this.options.orderContainerSelector+" "+this.options.orderElemSelector,$.proxy(this._evOnOrderChange,this))}if(this.options.hasRowCheck){this.$headerCheck=this.element.find(this.options.headerCheckSelector);this.element.on("click",this.options.rowCheckSelector,$.proxy(this._evOnRowCheckChange,this));this.element.on("change",this.options.headerCheckSelector,$.proxy(this._evOnHeaderCheckSelector,this));for(var b=0;b<this.options.filterButtons.length;b++){var c=this.options.filterButtons[b];(function(e,d){d.$actionsContainer.on("click",e.btnSelector,$.proxy(function(f){f.preventDefault();this.$rowsContainer.find(d.options.rowCheckSelector).parents(d.options.rowSelector).each($.proxy(function(j,i){var g=$(i);var h=e.filter.call(this,g);g.find(this.options.rowCheckSelector).prop("checked",h);h?g.addClass("selected"):g.removeClass("selected")},this));this._evOnRowCheckChange(null,$(f.currentTarget))},d))})(c,this)}if(this.options.gridActions!=null){for(var b=0;b<this.options.gridActions.length;b++){var c=this.options.gridActions[b];(function(f,e){if(f.popover){var d=e.$actionsContainer.find(f.btnSelector);d.bsInlineQuestion({placement:"bottom",question:"Are you sure?",buttons:[{text:"Yes",cssClass:"btn-primary bs-confirm",callback:$.proxy(function(){d.bsInlineQuestion("toggle");f.handler.call(this,this.element.find(this.options.rowSelector+".selected"),this)},e)},{text:"No",cssClass:"btn-default bs-cancel",callback:function(g){d.bsInlineQuestion("toggle")}}]});d.attr("title",d.attr("data-original-title")||"")}else{e.$actionsContainer.on("click",f.btnSelector,$.proxy(function(g){f.handler.call(this,this.element.find(this.options.rowSelector+".selected"),this)},e))}})(c,this)}}}this.element.on("click",".edit_col",$.proxy(this._evOnCellEdit,this));this.element.on("click",this.options.resetGridSelector,$.proxy(this._evResetGrid,this));this.element.on("click",this.options.errorCloseSelector,$.proxy(this._evOnErrorRemove,this));this.element.on("click",this.options.expandToggleSelector,$.proxy(this._evOnExpandToggle,this));this.element.on("click",this.options.addSelector,$.proxy(function(){if(this.options.$toolbar!=null&&typeof this.options.$toolbar.bsToolbar==="function"){this.options.$toolbar.bsToolbar("toggleControl","add")}},this))};a.prototype._initSelectors=function(){this.$rowsContainer=this.element.find(this.options.rowsContainerSelector);this.$gridContainer=this.element.find(this.options.gridContainerSelector);this.$gridCountContainer=this.element.find(this.options.gridCountContainerSelector);this.$filterIcon=this.element.find(this.options.filterSelector);this.$resetGridButton=this.element.find(this.options.resetGridSelector);this.$gridOrderContainer=this.element.find(this.options.orderContainerSelector);this.$actionsContainer=this.element.find(this.options.groupActionsSelector);this.$gridHeader=this.element.find(this.options.gridHeaderSelector);this.$expandToggle=this.element.find(this.options.expandToggleSelector);this.$gridRowsHeader=this.element.find(this.options.gridRowsHeaderSelector)};a.prototype._createActions=function(e,b){for(var d=0;d<e.length;d++){var c=e[d];if(typeof c.handler!=="function"&&typeof c.init!=="function"){throw"action with selector "+c.btnSelector+" has no click handler and no init handler"}if(typeof c.init==="function"){c.init.call(this,c,b,this)}if(typeof c.handler==="function"){b.on("click",c.btnSelector,{options:c},$.proxy(function(f){var g=f.data.options;g.handler.call(this,f,g,$(f.target).closest(this.options.rowSelector),this)},this))}}};a.prototype.search=function(b,c){if(b.Page){this.refreshModel.Page=b.Page}else{this.refreshModel.Page=1}if(c){this.refreshModel.quickSearch=b;this.refreshModel.Search=null}else{this.refreshModel.Search=b;this.refreshModel.quickSearch=null}this._showFilterIcon();if(c&&this.refreshModel.quickSearch==""){this._hideFilterIcon()}this._getPage()};a.prototype.reset=function(b,c){this.refreshModel.Page=1;this.refreshModel.Search=b;this.refreshModel.quickSearch=null;this._hideFilterIcon();if(c!==true){this._getPage()}};a.prototype.refresh=function(c,b){this._getPage()};a.prototype.add=function(f,d,e){if(typeof this.options.addValidation==="function"){var c=this.options.addValidation.apply(this,[d,e]);if(c===false){return}}var b=$(f);this._currentResultsCount++;this._changeCount();if(this.$rowsContainer.hasClass("no_results")){this.$rowsContainer.removeClass("no_results");this.$rowsContainer.children().remove();this.$gridRowsHeader.closest(".row").show()}this.$rowsContainer.prepend(b.find(this.options.rowSelector));this.$pager.bsPager("updateTotal",this._currentResultsCount);this.toggleBulkActions();this._updateExpandToggle();this.$rowsContainer.show();this.element.find(this.options.noResultsRowSelector).remove()};a.prototype._createDetails=function(){var b=this.element.find(this.options.detailsContainerSelector).each(function(d,c){this._createDetailsHelper($(c))},this)};a.prototype._createDetailsHelper=function(b){var c=b.closest(this.options.rowSelector);if(!c.data("objid")<0){throw"row with index "+c.index()+" has no objId set"}b.prepend('<a href="#" class="expand">&nbsp;</a>');var d=b.find(".expand");d.on("click",this._evOnDetailsClick,this)};a.prototype._evOnDetailsClick=function(f,d){f.preventDefault();f.stopPropagation();var b=$(f.currentTarget).closest(this.options.rowSelector);if(d!=null&&d.removeErrors){if(b.find(this.options.errorCloseSelector).length){b.find(this.options.errorCloseSelector).trigger("click");this._updateExpandToggle();return}}if(b.hasClass("open")){b.removeClass("open");b.children(this.options.rowDetailsSelector).stop(true,true).slideUp(400);this._updateExpandToggle();return}if(b.data("hasdetails")){this._handleDetails(b);return}var g={items:[{Id:b.data("objid"),GetDetails:true}]};this._addAdditionalData(g);var c={name:this.options.uniqueName+"|details|"+b.data("objId"),url:this.options.detailsUrl,data:g,callbackData:{sent:g,row:b,id:b.data("objid")},context:this,success:$.proxy(this._detailsAjaxSuccess,this),error:$.proxy(this._detailsAjaxError,this),loadingElement:b,loadingClass:"loading"};$.bforms.ajax(c)};a.prototype._detailsAjaxSuccess=function(c){var b=$(c.RowsHtml);b.find(this.options.rowSelector).each($.proxy(function(f,g){var e=$(g);var d=this._getRowElement(e.data("objid"));d.find(this.options.rowHeaderSelector).replaceWith(e.find(this.options.rowHeaderSelector));d.append(e.find(this.options.rowDetailsSelector).hide());c.$detailsHtml=d.find(this.options.rowDetailsSelector);this._trigger("beforeRowDetailsSuccess",0,{$row:d,data:c});d.stop(true,true).slideDown(800);this._handleDetails(d);d.data("hasdetails",true);this._createActions(this.options.rowActions,d);this._trigger("afterRowDetailsSuccess",0,{$row:d,data:c})},this))};a.prototype._detailsAjaxError=function(e){if(e.Message){var d=arguments[4].row;if(typeof d!=="undefined"&&d!=null){var b=d.find(".bs-validation_row");if(b.length==0){b=$('<div class="col-12 col-sm-12 col-lg-12 bs-validation_row"></div>');d.find(this.options.rowHeaderSelector).after(b)}this._addError(e.Message,b,true);this._updateExpandToggle()}else{var c=$(this.element).find(".bs-validation_summary");if(c.length==0){c=$('<div class="col-12 col-sm-12 col-lg-12 bs-validation_summary"></div>');this.element.find("h2").after(c)}this._addError(e.Message,c)}}};a.prototype._expandGridRow=function(b){b.addClass("open");b.find(this.options.rowDetailsSelector).stop(true,true).slideDown(800)};a.prototype._handleDetails=function(d){var c=this.element.find(this.options.rowSelector+".open"),e=false;if(c.length>0&&!this.options.multipleDetails){c.removeClass("open");var b=c.children(this.options.rowDetailsSelector);b.hide();if(this.options.removeDetailsOnCollapse){b.remove();c.data("hasdetails",false)}this._expandGridRow(d);$.bforms.scrollToElement(d);e=true}if(!e){this._expandGridRow(d)}this._updateExpandToggle()};a.prototype._getMultiDetails=function(e,c){var b=this.$rowsContainer.find(this.options.rowSelector).length==c.length?this.$rowsContainer:c,d={items:e};this._addAdditionalData(d);$.bforms.ajax({name:this.options.uniqueName+"|multiDetails",url:this.options.detailsUrl,data:d,callbackData:{items:e},context:this,success:$.proxy(this._detailsAjaxSuccess,this),error:$.proxy(this._detailsAjaxError,this),loadingElement:b,loadingClass:"loading"})};a.prototype._evOnPageChange=function(c,b){this.refreshModel.Page=b.page;var d=true;if(b.pageSize){this.refreshModel.PageSize=b.pageSize;d=false}this._getPage(d)};a.prototype._evOnPagerGoTop=function(c){var b=$([]);if(this.options.goTopElement!==null){b=$(this.options.goTopElement)}else{b=this.$gridHeader}if(b.length){$.bforms.scrollToElement(b)}};a.prototype._evOnOrderChange=function(c){c.preventDefault();if(!this._currentResultsCount){return}var d=$(c.currentTarget);var k="";var l="";var m=0;if(d.hasClass("sort_asc")){k="sort_desc";m=2}else{if(!d.hasClass("sort_desc")){k="sort_asc";m=1}}var h=d.parent().data("name");var j={Name:h,Type:m};if(this.options.multipleOrder){var b=false;for(var f=0;f<this.refreshModel.OrderableColumns.length;f++){var g=this.refreshModel.OrderableColumns[f];if(g.Name==h){if(m==0){this.refreshModel.OrderableColumns.splice(f,1)}else{g.Type=m}b=true;break}}if(!b){this.refreshModel.OrderableColumns.push(j)}d.removeClass("sort_asc").removeClass("sort_desc")}else{this.element.find(this.options.orderContainerSelector+" "+this.options.orderElemSelector).removeClass("sort_asc").removeClass("sort_desc");this.refreshModel.OrderableColumns=[];this.refreshModel.OrderableColumns.push(j)}if(m!=0){d.addClass(k)}this._getPage();if(!this._isInitialState()){this._showResetGridButton()}else{this._hideResetGridButton()}};a.prototype._evOnHeaderCheckSelector=function(f){var d=$(f.currentTarget).prop("checked");this.element.find(this.options.rowCheckSelector).prop("checked",d);var b=this.element.find(this.options.rowCheckSelector).parents(this.options.rowSelector);if(d){b.addClass("selected")}else{b.removeClass("selected")}var c=this.$actionsContainer.children("button");if(d){c.show();this._showResetGridButton()}else{c.hide();this._hideResetGridButton()}};a.prototype._evOnRowCheckChange=function(h,d){var b;if(h&&typeof h.stopPropagation=="function"){h.stopPropagation();b=$(h.currentTarget)}else{b=d}if(typeof b!=="undefined"&&b!=null){var c=b.closest(this.options.rowSelector);if(b.prop("checked")){c.addClass("selected")}else{c.removeClass("selected")}}var g=this.element.find(this.options.rowCheckSelector).filter(function(){return $(this).prop("checked")}).length;var f=this.$actionsContainer.children("button");if(g>0){f.show();this._showResetGridButton();if(g==this.element.find(this.options.rowCheckSelector).length){this.$headerCheck.prop("indeterminate",false)}else{this.$headerCheck.prop("indeterminate",true)}this.$headerCheck.prop("checked",true)}else{f.hide();this._resetHeaderCheck();this._hideResetGridButton()}};a.prototype._resetHeaderCheck=function(){if(this.$headerCheck){this.$headerCheck.prop("indeterminate",false);this.$headerCheck.prop("checked",false);this.$actionsContainer.children("button").hide()}};a.prototype._evOnCellEdit=function(d){d.preventDefault();d.stopPropagation();var g=$(d.currentTarget);var f=g.parent().index();var c=this.$gridOrderContainer.children(":eq("+f+")").children("form");var b=c.clone();var h=g.closest(this.options.rowSelector).data("id");b.find("*").each(function(j,i){var e=$(i);if(e.attr("id")){e.attr("id",e.attr("id")+"_"+h+"_"+f)}});g.after(b);g.hide();b.show()};a.prototype._evOnCellSave=function(c){c.preventDefault();var b=$(c.cuurentTarget).closest("form");$.validator.unobtrusive.parse(b);if(!b.valid()){return}var d=b.parseForm()};a.prototype._evResetGrid=function(b){b.stopPropagation();var c=false;this._resetHeaderCheck();this._uncheckAllRows();this._resetOrder();this._hideResetGridButton(true);this._removeErrors();if(this.refreshModel.PageSize!=this._initialModel.PageSize){c=true;this.refreshModel.PageSize=this._initialModel.PageSize;this.$pager.bsPager("selectValue",this.refreshModel.PageSize)}if(this.options.$toolbar!=null&&this.$filterIcon.is(":visible")){this.options.$toolbar.bsToolbar("reset",{preventPagination:false})}else{if(c===true){this.refreshModel.Page=1}this._getPage()}};a.prototype._evOnErrorRemove=function(b){if(this.element.find(".bs-form-error").length==1){window.setTimeout($.proxy(function(){this._hideResetGridButton();this._updateExpandToggle()},this),0)}};a.prototype._evOnExpandToggle=function(d){d.preventDefault();d.stopPropagation();if(this.$expandToggle.hasClass("open")){this.element.find(this.options.detailsSelector).trigger("click",{removeErrors:true})}else{var b=this.element.find(this.options.detailsSelector).parents(this.options.rowSelector).not(".open");var c=$();var f=b.map($.proxy(function(g,h){var e=$(h);if(e.data("hasdetails")){this._handleDetails(e)}else{if(e.find(this.options.errorCloseSelector).length==0){c=c.add(e);return{Id:e.data("objid"),getDetails:true}}}},this)).get();if(f.length){this._getMultiDetails(f,c)}}};a.prototype._onRowClick=function(d){if(!this._isTextSelected()){var b=$(d.currentTarget),c=$(d.target).closest(this.options.rowDetailsSelector).length>0,f=$(d.target).closest(".bs-form-error").length>0;if(!c&&!f){b.find(this.options.detailsSelector).trigger("click")}}};a.prototype._getPage=function(d){this.needsRefresh=false;var c=this._serializeRefreshModel();if(typeof this.options.onRefresh==="function"){this.options.onRefresh.call(this,c)}this._addAdditionalData(c);this._trigger("beforePager",c);var b={name:this.options.uniqueName+"|pager",url:this.options.pagerUrl,data:c,callbackData:{sent:c,pageChanged:d},context:this,success:$.proxy(this._pagerAjaxSuccess,this),error:$.proxy(this._pagerAjaxError,this),loadingElement:this.$rowsContainer,loadingDelay:100,loadingClass:"loading"};$.bforms.ajax(b)};a.prototype._pagerAjaxSuccess=function(f,e){this._trigger("beforePaginationSuccess",0,f);this._currentResultsCount=f.Count||0;var b=$(f.Html),d=$("<div></div>").append(b);if(this._currentResultsCount){this.$rowsContainer.html(b.html());this.$rowsContainer.removeClass("no_results");this.element.find(".bs-pager").show();this.$gridRowsHeader.closest(".row").show()}else{this.$rowsContainer.html(d.find(this.options.noResultsRowSelector));this.$rowsContainer.addClass("no_results");this.$gridRowsHeader.closest(".row").hide()}this.$pager.bsPager("update",b.closest(".bs-pages"));if(this._currentResultsCount==0){this.$actionsContainer.hide()}else{this.$actionsContainer.show()}this._changeCount();this._resetHeaderCheck();if(e.pageChanged){$.bforms.scrollToElement(this.$gridHeader)}if(this.refreshModel.DetailsAll||this.refreshModel.DetailsCount>0){var c=this.$rowsContainer.find(this.options.rowSelector);c.each($.proxy(function(g,h){this._initInitialDetails($(h))},this))}this.toggleBulkActions();this._updateExpandToggle();this._trigger("afterPaginationSuccess",0,f)};a.prototype._changeCount=function(){this.$gridCountContainer.html(this._currentResultsCount)};a.prototype._pagerAjaxError=function(c){this._trigger("beforePaginationError",0,c);if(c.Message){var b=$(this.element).find(".bs-validation_summary");if(b.length==0){b=$('<div class="col-12 col-sm-12 col-lg-12 bs-validation_summary"></div>');this.element.find("h2").after(b)}this._addError(c.Message,b)}if(arguments[4]&&arguments[4].pageChanged){$.bforms.scrollToElement(this.$gridHeader)}this._trigger("afterPaginationError",0,c)};a.prototype._initSortable=function(){this.$gridOrderContainer.find("header").sortable({start:$.proxy(this._onSortStart,this),stop:$.proxy(this._onSortStop,this),update:$.proxy(this._onSortUpdate,this),containment:"parent",distance:10,cursor:"move",tolerance:"pointer",helper:"clone"})};a.prototype._onSortStart=function(b,c){this.$rowsContainer.addClass("loading");c.item.data("startpos",c.item.index());this.element.find(this.options.expandToggleSelector).hide()};a.prototype._onSortStop=function(b,d){var c=d.item.data("startpos");if(c==d.item.index()){this.$rowsContainer.removeClass("loading");this.$expandToggle.show()}};a.prototype._onSortUpdate=function(b,c){this.refreshModel.OrderColumns=this._getColumnsOrder();this._getPage();this.$expandToggle.show()};a.prototype._showFilterIcon=function(){this.$filterIcon.show();this._showResetGridButton()};a.prototype._hideFilterIcon=function(){this.$filterIcon.hide();this._hideResetGridButton()};a.prototype._showResetGridButton=function(){this.$resetGridButton.show()};a.prototype._hideResetGridButton=function(b){if(this._isInitialState()||b===true){this.$resetGridButton.hide()}};a.prototype._isInitialState=function(){if(this.$filterIcon.is(":visible")){return false}if(this.element.find(this.options.errorCloseSelector).length){return false}var c=this.element.find(this.options.detailsSelector).parents(this.options.rowSelector+'[data-expandedonload="True"]');var b=this.element.find(this.options.detailsSelector).parents(this.options.rowSelector).not(c);var e=c.filter(function(){return $(this).hasClass("open")}).length,d=b.not(".open").length;if(c.length!=e||b.length!=d){return false}if(this.element.find(this.options.rowCheckSelector).filter(function(){return $(this).prop("checked")}).length>0){return false}return true};a.prototype._uncheckAllRows=function(){var b=this.element.find(this.options.rowsContainerSelector+">"+this.options.rowSelector);this.element.find(this.options.rowCheckSelector).prop("checked",false);b.removeClass("selected")};a.prototype._resetOrder=function(){this.element.find(this.options.orderContainerSelector+" "+this.options.orderElemSelector).removeClass("sort_asc sort_desc");this.refreshModel.OrderableColumns=[]};a.prototype._removeErrors=function(){this.element.find(this.options.errorCloseSelector).trigger("click")};a.prototype._updateExpandToggle=function(){if(this.element.find(this.options.detailsSelector).length>0){this.$expandToggle.show()}else{this.$expandToggle.hide()}var c=false;var b=this.element.find(this.options.detailsSelector).parents(this.options.rowSelector).not(".open");var d=b.length-b.find(this.options.errorCloseSelector).length;if(d==0){c=true}if(this._isInitialState()){this._hideResetGridButton()}else{this._showResetGridButton()}if(c){this.$expandToggle.addClass("open")}else{this.$expandToggle.removeClass("open")}};a.prototype._getColumnsOrder=function(){var b=[];this.$gridOrderContainer.find("*[data-name]").each(function(d,c){b.push({key:$(c).data("name"),value:d})});return b};a.prototype._getRowElement=function(b){return this.element.find(this.options.rowSelector+'[data-objid="'+b+'"]')};a.prototype._initInitialDetails=function(b){var c={$detailsHtml:b.find(this.options.rowDetailsSelector)};if(c.$detailsHtml.length){this._trigger("beforeRowDetailsSuccess",0,{$row:b,data:c});this._handleDetails(b);b.data("hasdetails",true);this._createActions(this.options.rowActions,b);this._trigger("afterRowDetailsSuccess",0,{$row:b,data:c})}};a.prototype._isTextSelected=function(){var b="";if(typeof window.getSelection!="undefined"){b=window.getSelection().toString()}else{if(typeof document.selection!="undefined"&&document.selection.type=="Text"){b=document.selection.createRange().text}}return b!==""};a.prototype.toggleBulkActions=function(){if(this.element.find(this.options.rowCheckSelector).length>0){this.element.find(this.options.groupActionsSelector).show()}else{this.element.find(this.options.groupActionsSelector).hide()}};a.prototype._serializeRefreshModel=function(){var b={};for(var d in this.refreshModel){if(d in this.refreshModel){var e=this.refreshModel[d];if(e instanceof Array||typeof(e)!=="object"){b[d]=this.refreshModel[d]}else{for(var c in e){if(c in e){b[c]=e[c]}}}}}return b};a.prototype._addAdditionalData=function(b){if(typeof this.options.additionalData!=="undefined"){$.extend(true,b,this.options.additionalData)}};a.prototype.updateRow=function(f,d,e){var c={items:[{Id:f.data("objid"),GetDetails:d||true}]};this._addAdditionalData(c);var b={name:this.options.uniqueName+"|UpdateRow|"+c.objId,url:this.options.detailsUrl,data:c,callbackData:{sent:c,row:f},context:this,success:$.proxy(this._updateRowAjaxSuccess,this),error:$.proxy(this._updateRowAjaxError,this),loadingElement:f,loadingClass:"loading"};$.bforms.ajax(b)};a.prototype._updateRowAjaxSuccess=function(c,b){this.updateRows(c.RowsHtml)};a.prototype._updateRowAjaxError=function(d){if(d.Message){var c=arguments[4].row;var b=c.find(this.options.errorRowContainer);if(b.length==0){b=$('<div class="col-12 col-sm-12 col-lg-12 bs-validation_row"></div>');c.find(this.options.rowHeaderSelector).after(b)}this._addError(d.Message,b,true)}};a.prototype._rowActionAjaxError=function(d,c){if(d.Message){var b=c.find(".bs-validation_row_control");if(b.length==0){b=$('<div class="col-12 col-sm-12 col-lg-12 bs-validation_row_control"></div>');c.find(this.options.rowActionsContainerSelector).before(b)}this._addError(d.Message,b,true)}};a.prototype._addError=function(d,c,e){var b=$('<div class="bs-form-error alert alert-danger"><button class="close" data-dismiss="alert" type="button">×</button>'+d+"</div>");if(e){c.html(b)}else{c.append(b)}this._showResetGridButton()};a.prototype.updateRows=function(d){var b=$(d);var c=b.find(this.options.rowSelector);c.each($.proxy(function(i,k){var f=$(k),j=f.data("objid");var e=this._getRowElement(j);if(this.options.hasRowCheck){var h=e.find(this.options.rowCheckSelector).prop("checked");var g=f.find(this.options.rowCheckSelector);if(g.length){f.find(this.options.rowCheckSelector).prop("checked",h);if(h){f.addClass("selected")}}}e.find(".bs-hasPanel").each(function(o,n){var l=$(n);if(l.hasClass("bs-panelEditMode")){var m=f.find("#"+l.attr("id"));m.replaceWith(l)}});e.replaceWith(f);this._initInitialDetails(f);this._evOnRowCheckChange()},this));this._updateExpandToggle()};a.prototype.getSelectedRows=function(){var c=this.element.find(this.options.rowSelector+".selected");var b=c.map(function(e,f){var d=$(f);return{Id:d.data("objid"),GetDetails:d.hasClass("open")}}).get();return b};a.prototype.enableRowActions=function(c){var b=typeof c==="number"?this._getRowElement(id):c;b.find(this.options.rowActionsContainerSelector).find(".disabled").removeClass("disabled")};a.prototype.disableRowActions=function(c){var b=typeof c==="number"?this._getRowElement(id):c;b.find(this.options.rowActionsContainerSelector).find("button").addClass("disabled")};$.widget("bforms.bsGrid",a.prototype);return a});define("bforms-toolbar",["bforms-toolbar-advancedSearch","bforms-toolbar-add","bforms-toolbar-quickSearch","bforms-toolbar-order","jquery","jquery-ui-core","amplify","bforms-form"],function(b,a,d,c){jQuery.nsx("bforms.toolbar.defaults");jQuery.nsx("bforms.toolbar.controls");var e=function(f){this.options=f;this._create()};e.prototype.options={uniqueName:null,saveTabState:true,tabContainerSelector:".grid_toolbar_form",autoInitControls:true,reset:null,controls:null};e.prototype._create=function(){$.bforms.toolbar.defaults.AdvancedSearch=b;$.bforms.toolbar.defaults.Add=a;$.bforms.toolbar.defaults.QuickSearch=d;$.bforms.toolbar.defaults.Order=c};e.prototype._init=function(){if(!this.options.uniqueName){this.options.uniqueName=this.element.attr("id")}if(!this.options.uniqueName){throw"toolbar needs a unique name or the element on which it is aplied has to have an id attr"}this._controls=[];if(this.options.autoInitControls){for(var j in $.bforms.toolbar.defaults){if(j in $.bforms.toolbar.defaults){var g=new $.bforms.toolbar.defaults[j](this.element);var f=this.element.find(g._defaultOptions.selector);if(f.length>0){g.$element=f;this._controls.push(g)}}}for(var j in $.bforms.toolbar.controls){if(j in $.bforms.toolbar.controls){var g=new $.bforms.toolbar.controls[j](this.element);var f=this.element.find(g._defaultOptions.selector);if(f.length>0){g.$element=f;this._controls.push(g)}}}}if(this.options.controls instanceof Array){for(var h=0;h<this.options.controls.length;h++){var g=new this.options.controls[h](this.element);var f=this.element.find(g._defaultOptions.selector);if(f.length>0){g.$element=f;this._controls.push(g)}}}this.subscribers=new Array();if(this.options.subscribers){this._addSubscribers(this.options.subscribers)}this._addControls(this._controls);this._expandSavedTab()};e.prototype.reset=function(){this._reset(arguments);if(typeof this.options.reset==="function"){this.options.reset.apply(this,arguments)}};e.prototype._reset=function(j){var k=true,l=this.getControl("quickSearch");if(typeof j!=="undefined"){k=j.preventPagination}if(l!=null){l.$element.find("input").val("")}var f=this.getControl("advancedSearch"),g;if(f!=null){f.$container.bsForm("reset");g=f.$container.bsForm("parse")}var m=this.element.data("bformsBsToolbar");for(var h=0;h<m.subscribers.length;h++){m.subscribers[h].bsGrid("reset",g,k)}};e.prototype._addDelegates=function(){};e.prototype.controls=function(h){for(var j=0;j<h.length;j++){var g=h[j];var f=this.element.find(g._defaultOptions.selector);if(f.length>0){g.$element=f;this._controls.push(g)}}this._addControls(h)};e.prototype._addControls=function(g){if(!g){return}for(var h=0;h<g.length;h++){var f=g[h];switch(f.type){case"action":this._addAction(f);break;case"tab":this._addTab(f);f.init();break;default:this._addCustomControl(f);f.init();break}}};e.prototype._addTab=function(f){f.$container=$("#"+f.$element.data("tabid"));f.$element.on("click",{tab:f},$.proxy(this._evBtnTabClick,this))};e.prototype._expandSavedTab=function(){if(this.options.saveTabState){var h=this._getTabs();for(var f=0;f<h.length;f++){var g=h[f];if(amplify.store("slide|"+this.options.uniqueName+"|"+g.options.selector)){g.$element.trigger("click")}}}};e.prototype._addCustomControl=function(f){if(typeof f.name!=="string"||f.name.trim().length==0){throw"all controls must have a name"}if(typeof f.options.selector!=="string"||f.options.selector.trim().length==0){throw"all controls must have a name"}};e.prototype._addAction=function(g){if(typeof g.handler!=="function"){throw"action "+g.name+" must implement an event handler"}var f=this.element.find(g.selector);f.on("click",{buttonOpt:g},$.proxy(this._evBtnClick,this));var h={name:g.name,type:"action",$element:f,options:g};this._controls.push(h)};e.prototype._addSubscribers=function(g){for(var f=0;f<g.length;f++){this._addSubscriber(g[f])}};e.prototype._addSubscriber=function(f){this.subscribers.push(f)};e.prototype._evBtnClick=function(g){g.preventDefault();var f=g.data.buttonOpt;f.handler.call(this,g)};e.prototype._evBtnTabClick=function(g,h){g.preventDefault();var f=g.data.tab;if(this._selectedTab!=null&&this._selectedTab.name!=f.name){this._toggleTab(this._selectedTab)}this._toggleTab(f)};e.prototype._toggleTab=function(h){if(h==null){return}h.$element.toggleClass("selected");if(h.name=="advancedSearch"){var g=this.getControl("quickSearch");if(g!=null){g.$element.toggleClass("selected")}}h.$container.stop(true,false).slideToggle();var f=h.$element.hasClass("selected");if(this.options.saveTabState){amplify.store("slide|"+this.options.uniqueName+"|"+h.options.selector,f)}if(f){this._selectedTab=h}else{this._selectedTab=null}};e.prototype._getTabs=function(){return this._controls.filter(function(f){return f.type=="tab"})};e.prototype.getControl=function(g){var f=$.grep(this._controls,function(h){return h.name==g});if(f!=null&&f[0]!=null){return f[0]}return null};e.prototype.toggleControl=function(g,h){var f=this.getControl(g);if(f!=null&&f.type=="tab"){if(typeof h!=="undefined"){if(h==true){if(this._selectedTab!=null){if(this._selectedTab.name!=f.name){this._toggleTab(this._selectedTab);this._toggleTab(f)}}else{this._toggleTab(f)}}else{if(this._selectedTab!=null&&this._selectedTab.name==f.name){this._toggleTab(f)}}}else{if(this._selectedTab!=null&&this._selectedTab.name!=f.name){this._toggleTab(this._selectedTab)}this._toggleTab(f)}}return f};$.widget("bforms.bsToolbar",e.prototype)});define("bforms-pager",["jquery","jquery-ui-core"],function(){var a=function(b){this.options=b;this._create()};a.prototype.options={pagesContainerSelector:".bs-pages",pageSelector:"a[data-page]",pageSizeSelector:".bs-perPage",currentPageSelector:"active",disabledPageSelector:"disabled",totalsContainerSelector:".results_number span",pageSizeContainerSelector:".results_per_page",perPageDisplaySelector:".bs-perPageDisplay",goTopButtonSelector:".bs-goTop"};a.prototype._create=function(){this._addDelegates()};a.prototype._addDelegates=function(){this.element.on("click",this.options.pageSelector,$.proxy(this._evPageChanged,this));this.element.on("click",this.options.pageSizeSelector,$.proxy(this._evPageSizeChanged,this));this.element.on("click",this.options.goTopButtonSelector,$.proxy(this._evGoTopClick,this))};a.prototype._evPageChanged=function(d){d.preventDefault();var b=$(d.currentTarget),c=b.parent();if(c.hasClass(this.options.currentPageSelector)||c.hasClass(this.options.disabledPageSelector)){return}this._trigger("pagerUpdate",d,{page:b.data("page"),pageSize:this.element.find(this.options.pageSizeSelector+".selected").data("value")})};a.prototype._evPageSizeChanged=function(b){b.preventDefault();var c=$(b.currentTarget).data("value");this.element.find(".selected").removeClass("selected");$(b.currentTarget).addClass("selected");this.element.find(this.options.perPageDisplaySelector).html(c+'<span class="caret"></span>');this._trigger("pagerUpdate",b,{page:1,pageSize:$(b.currentTarget).data("value")})};a.prototype._evGoTopClick=function(b){this._trigger("pagerGoTop",b)};a.prototype._btnClickAjaxSuccess=function(c,b){if(typeof b.handler==="function"){b.handler.call(this,b.sent,c)}};a.prototype._btnClickAjaxError=function(){throw"not implemented error handler"};a.prototype.update=function(c){var d=this.element.find(this.options.pageSizeContainerSelector);var b=this.element.find(this.options.pagesContainerSelector);if(b.length>0){b.html(c.children())}else{this.element.html(c)}c.length==0?d.hide():d.show()};a.prototype.updateTotal=function(b){this.element.find(this.options.totalsContainerSelector).html(b)};a.prototype.selectValue=function(c){var b=this.element.find(this.options.pageSizeSelector+'[data-value="'+c+'"]');if(b.length){this.element.find(".selected").removeClass("selected");b.addClass("selected");this.element.find(this.options.perPageDisplaySelector).html(c+'<span class="caret"></span>')}};a.prototype.getPageSize=function(){return this.element.find(this.options.pageSizeSelector+".selected").data("value")};$.widget("bforms.bsPager",a.prototype);return a});define("bforms-editable",["jquery","bforms-extensions","jquery-ui-core","bforms-initUI","bforms-ajax"],function(){var a=function(b){this.options=b;this._init()};a.prototype.options={uniqueName:null,isGroup:true,toggles:true,editFirst:false,editOnly:false,headerSelector:"h3",headerSelectorTrigger:"open-editable",saveClass:"btn-success",cancelClass:"btn-danger",readOnlySelector:".bs-readonly",editorSelector:"form",editModeSelector:"bs-edit_mode",url:null,additionalData:{},editSuccessHandler:null,initPlugins:null};a.prototype._init=function(){if(this.element.hasClass("bs-editable_applied")){return}if(!this.options.uniqueName){this.options.uniqueName=this.element.attr("id")}if(!this.options.uniqueName){throw"editable needs a unique name or the element on which it is aplied has to have an id attr"}if(!this.options.url){throw"url must have a value"}this._initSelectors();this._addDelegates();if(this.options.toggles){this.element.find(this.options.headerSelector).addClass("editable")}this._createControls();if(typeof this.options.initPlugins==="function"){this.options.initPlugins.call(this)}if(this.options.editFirst||this.options.editOnly){this._switchToEditable()}var b=this.element.bsInitUI();b.done($.proxy(function(){this._trigger("afterFormInit",{editable:this,$element:this.element})},this));this.element.addClass("bs-editable_applied")};a.prototype._initSelectors=function(){this.$readOnly=this.element.find(this.options.readOnlySelector);this.$editor=this.element.find(this.options.editorSelector);this.$header=this.element.find(this.options.headerSelector)};a.prototype._addDelegates=function(){if(this.options.toggles){this.$header.on("click",$.proxy(this._evOnHeaderClick,this))}};a.prototype.initValidation=function(){if(this.$editor.length){$.validator.unobtrusive.parse(this.$editor);this.$editor.validate()}};a.prototype._createControls=function(){if(this.options.editOnly||this.options.toggles){var c=$('<a title="Save"></a>').addClass(this.options.saveClass).addClass("btn").html('<span class="glyphicon glyphicon-ok"></span> ').attr("href","#").on("click",$.proxy(this._evOnSaveClick,this));if(this.options.toggles){var b=$('<a title="Cancel"></a>').addClass(this.options.cancelClass).addClass("btn").html('<span class="glyphicon glyphicon-remove"></span> ').attr("href","#").on("click",$.proxy(this._evOnCancelClick,this))}this.$controls=$("<span></span>").addClass("controls").append(c).append(b).appendTo(this.$header).hide()}};a.prototype._evOnHeaderClick=function(d){d.preventDefault();var b=$(d.currentTarget);var c=$(d.target);if(b.data("editmode")||(!c.hasClass(this.options.headerSelectorTrigger)&&d.currentTarget!=d.target)){return}this._switchToEditable()};a.prototype._evOnSaveClick=function(g){g.preventDefault();var c=$(g.currentTarget);var b=this.$editor;if(b.length>0){$.validator.unobtrusive.parse(b);var h=b.validate();h.settings.partialNameSearch=true;if(!b.valid()){return}}var f=this.options.prefix?b.parseForm(this.options.prefix):b.parseForm();$.extend(true,f,this.options.additionalData);this._trigger("beforeSaveAjax",0,f);f.Type=this.element.data("type");var d={name:this.options.uniqueName,url:this.options.url,data:f,callbackData:{sent:f},context:this,success:$.proxy(this._saveAjaxSuccess,this),error:$.proxy(this._saveAjaxError,this),validationError:$.proxy(this._saveAjaxValidationError,this),loadingElement:this.element,loadingClass:"loading"};$.bforms.ajax(d)};a.prototype._saveAjaxValidationError=function(c,b){if(c){var d=this.$editor.data("validator");d.showErrors(c.Errors)}};a.prototype._saveAjaxSuccess=function(c,b){if(typeof this.options.editSuccessHandler==="function"){this.options.editSuccessHandler.call(this,c)}if(this.options.editOnly){return}this.$readOnly.html($(c.Html).html());this._switchToReadOnly()};a.prototype._saveAjaxError=function(b){if(b.Message){var c=this.$editor.data("validator");c.showSummaryError(b.Message)}};a.prototype._evOnCancelClick=function(b){b.preventDefault();this._switchToReadOnly()};a.prototype._switchToEditable=function(){this.$readOnly.hide();this.$editor.show();this.$controls.show();this.$header.data("editmode",true);this.$header.removeClass("editable")};a.prototype._switchToReadOnly=function(){this.$readOnly.show();this.$editor.hide();this.$controls.hide();this.$header.data("editmode",false);this.$header.addClass("editable")};a.prototype._destroy=function(){this.element.removeClass("bs-editable_applied")};$.widget("bforms.bsEditable",a.prototype);return a});define("bforms-form",["jquery","bforms-extensions","jquery-ui-core","bforms-validate-unobtrusive","bforms-initUI","bforms-ajax"],function(){var a=function(b){this.options=b;this._create()};a.prototype.options={uniqueName:null,hasGroupToggle:true,style:{},groupToggleSelector:".bs-group_toggle",groupToggleContainerSelector:".bs-group_toggle_container",groupToggleUp:"glyphicon-chevron-up",groupToggleDown:"glyphicon-chevron-down",glyphClass:".glyphicon",actions:[]};a.prototype._init=function(){if(!this.options.uniqueName){this.options.uniqueName=this.element.attr("id")}if(!this.options.uniqueName){throw"form needs a unique name or the element on which it is aplied has to have an id attr"}this._buttons=new Array();this._initSelectors();this._addDelegates();this._addActions(this.options.actions);var b=this.$form.bsInitUI(this.options.style);b.done($.proxy(function(){this._trigger("afterInitUI",0,{name:this.options.uniqueName,form:this.$form})},this))};a.prototype._initSelectors=function(){this.$form=this.element.is("form")?this.element:this.element.find("form")};a.prototype._addDelegates=function(){if(this.options.hasGroupToggle){this.element.find(this.options.groupToggleSelector).on("click",$.proxy(this._evToggleGroup,this))}};a.prototype._addActions=function(b){if(b){for(var c=0;c<b.length;c++){this._addAction(b[c])}}};a.prototype._addAction=function(c){var b=this.element.find(c.selector);if(b.length==0){throw"element with selector "+c.selector+" is not found in form container "+this.options.uniqueName}b.on("click",{buttonOpt:c,handlerContext:this.options.handlerContext},$.proxy(this._evBtnClick,this));this._buttons.push({name:c.name,elem:b})};a.prototype._evBtnClick=function(g){g.preventDefault();var b=$(g.currentTarget);var d=g.data.buttonOpt;var h=g.data.handlerContext;if(d.validate){this.$form.removeData("validator").removeData("unobtrusiveValidation");$.validator.unobtrusive.parse(this.$form);var i=this.$form.validate();this._trigger("beforeFormValidation",0,{validator:i,form:this.$form,name:this.options.uniqueName});if(!this.$form.valid()){return}}var f;if(d.parse){f=this._parse();if(typeof d.getExtraData==="function"){d.getExtraData.call(this,f)}this._trigger("beforeFormSubmit",0,{$button:b,buttonOpt:d,data:f})}var c=b.data("action")||d.actionUrl;if(c){$.bforms.ajax({name:this.options.uniqueName,url:c,data:f,callbackData:{handler:d.handler,handlerContext:h,sent:f},context:this,success:$.proxy(this._btnClickAjaxSuccess,this),error:$.proxy(this._btnClickAjaxError,this),loadingElement:this.element,loadingClass:"loading",validationError:function(e){if(e!=null&&e.Errors!=null){if(typeof i==="undefined"){$.validator.unobtrusive.parse(this.$form);i=this.$form.validate()}i.showErrors(e.Errors)}}})}else{if(typeof d.handler!=="function"){throw"action "+d.name+" must implement an event handler or have an url option"}d.handler.call(this,f)}};a.prototype._parse=function(){return this.element.parseForm(this.options.prefix?this.options.prefix:"")};a.prototype._btnClickAjaxSuccess=function(c,b){if(typeof b.handler==="function"){b.handler.call(this,b.sent,c,this)}};a.prototype._btnClickAjaxError=function(b){if(b.Message){var c=this.$form.data("validator");c.showSummaryError(b.Message)}};a.prototype._evToggleGroup=function(c){var b=$(c.currentTarget);b.find(this.options.glyphClass).toggleClass(this.options.groupToggleUp).toggleClass(this.options.groupToggleDown);b.toggleClass("open").closest(this.options.groupToggleContainerSelector).next().stop().slideToggle()};a.prototype.getFormData=function(b){var c=this.element.find("form");c.removeData("validator");c.removeData("unobtrusiveValidation");$.validator.unobtrusive.parse(c);var d=c.validate();this._trigger("beforeFormValidation",0,{validator:d,form:c,name:this.options.uniqueName});if(c.valid()){b=this._parse()}};a.prototype.parse=function(b){return this._parse()};a.prototype.reset=function(b){this.element.bsResetForm(true)};$.widget("bforms.bsForm",a.prototype);return a});define("bforms-toolbar-advancedSearch",["jquery","bforms-toolbar","bforms-form"],function(){var a=function(b,c){this.name="advancedSearch";this.type="tab";this.$toolbar=b;this.options=$.extend(true,{},this._defaultOptions,c);this.widget=this.$toolbar.data("bformsBsToolbar");this._controls={};this._addDefaultOptions()};a.prototype._defaultOptions={selector:".bs-show_advanced_search"};a.prototype.init=function(){var c=[];for(var d in this._controls){if(d in this._controls){c.push(this._controls[d])}}var b=this.$container.find(this._defaultOptions.selector);this.$searchForm=this.$container.bsForm({container:b.attr("id"),actions:c})};a.prototype._addDefaultOptions=function(){var c={name:"search",selector:".js-btn-search",validate:false,parse:true,handler:$.proxy(this._evOnSearch,this)};this._controls.search=c;var b={name:"reset",selector:".js-btn-reset",validate:false,parse:true,handler:$.proxy(this._evOnReset,this)};this._controls.reset=b};a.prototype.setControl=function(c,d){var b=this._controls[c];if(b){b=$.extend(true,{},b,d)}this._controls[c]=b};a.prototype._evOnSearch=function(b){for(var c=0;c<this.widget.subscribers.length;c++){this.widget.subscribers[c].bsGrid("search",b)}};a.prototype._evOnReset=function(){this.$searchForm.bsForm("reset");var b={};this.$searchForm.bsForm("getFormData",b);for(var c=0;c<this.widget.subscribers.length;c++){this.widget.subscribers[c].bsGrid("reset",b)}};return a});define("bforms-toolbar-add",["jquery","bforms-toolbar","bforms-form"],function(){var a=function(b,c){this.name="add";this.type="tab";this.$toolbar=b;this.options=$.extend(true,{},this._defaultOptions,c);this.widget=this.$toolbar.data("bformsBsToolbar");this._controls={};this._addDefaultOptions()};a.prototype._defaultOptions={selector:".bs-show_add"};a.prototype.init=function(){var b=this.$container.find(this._defaultOptions.selector);var c=[];for(var d in this._controls){if(d in this._controls){c.push(this._controls[d])}}this.$addForm=this.$container.bsForm({container:b.attr("id"),actions:c})};a.prototype._addDefaultOptions=function(){var b={name:"save",selector:".js-btn-save",validate:true,parse:true,handler:$.proxy(this._evOnAdd,this)};this._controls.save=b;var c={name:"reset",selector:".js-btn-reset",validate:false,parse:false,handler:$.proxy(this._evOnReset,this)};this._controls.reset=c};a.prototype.setControl=function(c,d){var b=this._controls[c];if(b){b=$.extend(true,{},b,d)}this._controls[c]=b};a.prototype._evOnAdd=function(b,d){for(var c=0;c<this.widget.subscribers.length;c++){this.widget.subscribers[c].bsGrid("add",d.Row,b,d)}this.$addForm.bsForm("reset")};a.prototype._evOnReset=function(b){this.$addForm.bsForm("reset")};return a});define("bforms-toolbar-quickSearch",["jquery"],function(){var a=function(b,c){this.name="quickSearch";this.type="custom";this.$toolbar=b;this.options=$.extend(true,{},this._defaultOptions,c)};a.prototype._defaultOptions={selector:".bs-quick_search",instant:true,timeout:250};a.prototype.init=function(){this.widget=this.$toolbar.data("bformsBsToolbar");this.$toolbar.on("keyup",this.options.selector+" .bs-text",$.proxy(this._evOnQuickSearchKeyup,this))};a.prototype._evOnQuickSearchKeyup=function(d){var b=$(d.currentTarget);var f=b.val().trim();if(f.length==0&&b.data("empty")){return}var c=this.widget.getControl("advancedSearch");if(c!=null&&c.$element.hasClass("selected")){c.$element.trigger("click")}if(f.length==0){b.data("empty",true)}else{b.data("empty",false)}if(this.options.instant){window.clearTimeout(this.quickSearchTimeout);this.quickSearchTimeout=window.setTimeout($.proxy(function(){this._search(f)},this),this.options.timeout)}else{if(d.which==13||d.keyCode==13){this._search(f)}}};a.prototype._search=function(c){for(var b=0;b<this.widget.subscribers.length;b++){this.widget.subscribers[b].bsGrid("search",c,true)}};return a});define("bforms-toolbar-order",["jquery","bforms-toolbar","bforms-form","bforms-sortable"],function(){var a=function(b,c){this.options=$.extend(true,{},this._defaultOptions,c);this.name="order";this.type="tab";this.$toolbar=b;this.widget=b.data("bformsBsToolbar");this._controls={};this.updated=false;this.currentConnection={};this._addDefaultControls()};a.prototype.init=function(){var b=this.$container.find(this.options.selector);var c=[];for(var d in this._controls){if(this._controls.hasOwnProperty(d)){c.push(this._controls[d])}}this.$orderForm=this.$container.bsForm({container:b.attr("id"),actions:c});this.$sortable=$(this.options.containerSelector);this.bsSortableOptions={itemSelector:this.options.itemSelector,listSelector:this.options.listSelector,containerSelector:this.options.containerSelector,serialize:this.options.serialize};this.$sortable.bsSortable(this.bsSortableOptions);this.previousConfigurationHtml=this.$sortable.html();this._addDelegates()};a.prototype._defaultOptions={selector:".bs-show_order",itemSelector:".bs-sortable-item",listSelector:".bs-sortable",containerSelector:".sortable-container",serialize:"array"};a.prototype._addDefaultControls=function(){this._controls.reset={name:"reset",selector:".js-btn-reset",validate:false,parse:false,handler:$.proxy(this._evOnReset,this)};this._controls.save={name:"save",selector:".js-btn-save_order",validate:false,parse:false,handler:$.proxy(this._evOnSave,this)}};a.prototype.setControl=function(c,d){var b=this._controls[c];if(b){b=$.extend(true,{},b,d)}this._controls[c]=b};a.prototype._addDelegates=function(){$(this.options.containerSelector).on("update",$.proxy(this._evOnUpdate,this))};a.prototype._evOnUpdate=function(b){this.reorderedList=b.updatedList;this.updated=true};a.prototype._evOnReset=function(){this.$sortable.html(this.previousConfigurationHtml);$(".placeholder").remove();this.$sortable.bsSortable(this.bsSortableOptions)};a.prototype._evOnSave=function(){if(this.updated){$(this._controls.save.selector).attr("disabled",true);this.$orderForm.attr("disabled",true);var b=this.reorderedList;var c=$(this._controls.save.selector).data("url");$(".loading-global").show();$.bforms.ajax({data:{model:b},url:c,success:this._reorderSuccess,error:this._reorderError,context:this,loadingClass:".loading-global"})}};a.prototype._reorderError=function(b){$(".loading-global").hide();this.$orderForm.removeAttr("disabled");$(this._controls.save.selector).attr("disabled",false);this.updated=false};a.prototype._reorderSuccess=function(b){this.updated=false;$(".loading-global").hide();this.$orderForm.removeAttr("disabled");$(this._controls.save.selector).attr("disabled",false);this.previousConfigurationHtml=this.$sortable.html()};return a});define("bforms-groupEditor",["singleton-ich","jquery","jquery-ui-core","bforms-pager","bforms-ajax","bforms-namespace","bforms-inlineQuestion","bforms-form"],function(b){var a=function(c){this.options=$.extend(true,{},this.options,c);this._init()};a.prototype.options={uniqueName:"",tabsSelector:".bs-tabs",groupsSelector:".bs-groups",navbarSelector:".bs-navbar",toolbarBtnSelector:".bs-toolbarBtn",editorFormSelector:".bs-editorForm",pagerSelector:".bs-pager",tabContentSelector:".bs-tabContent",tabItemSelector:".bs-tabItem",groupItemSelector:".bs-groupItem",groupItemTemplateSelector:".bs-itemTemplate",groupItemContentSelector:".bs-itemContent",groupItemsWrapper:".bs-itemsWrapper",groupItemsCounter:".bs-counter",removeBtn:".bs-removeBtn",addBtn:".bs-addBtn",editBtn:".bs-editBtn",upBtn:".bs-upBtn",downBtn:".bs-downBtn",toggleExpandBtn:".bs-toggleExpand",getTabUrl:"",};a.prototype._init=function(){if(!this.options.uniqueName){this.options.uniqueName=this.element.attr("id")}if(!this.options.uniqueName){throw"grid needs a unique name or the element on which it is aplied has to have an id attr"}this._initSelectors();this._initComponents();this._addDelegates();this._initSelectedTab();this._initTabForms()};a.prototype._initComponents=function(){this.renderer=b.getInstance();this._countGroupItems();this._checkEditable()};a.prototype._initSelectors=function(){this.$navbar=this.element.find(this.options.navbarSelector);this.$tabs=this.element.find(this.options.tabsSelector);this.$groups=this.element.find(this.options.groupsSelector);this.$counter=this.$groups.find(this.options.groupItemsCounter)};a.prototype._addDelegates=function(){this.$navbar.on("click","a",$.proxy(this._evChangeTab,this));this.$tabs.find("div[data-tabid]").on("click","button"+this.options.toolbarBtnSelector,$.proxy(this._evChangeToolbarForm,this));this.$tabs.on("click",this.options.addBtn,$.proxy(this._evAdd,this));this.$groups.on("click",this.options.removeBtn,$.proxy(this._evRemove,this));this.$groups.on("click",this.options.editBtn,$.proxy(this._evEdit,this));this.$groups.on("click",this.options.upBtn,$.proxy(this._evUp,this));this.$groups.on("click",this.options.downBtn,$.proxy(this._evDown,this));this.$groups.on("click",this.options.toggleExpandBtn,$.proxy(this._evToggleExpand,this))};a.prototype._initSelectedTab=function(){this._initTab(this._getSelectedTab())};a.prototype._initTabForms=function(){var c=this.element.find(this.options.editorFormSelector);$.each(c,function(d){$(this).bsForm({uniqueName:$(this).data("uid")+d})})};a.prototype._initTab=function(e){var d=this;if(e){var c=true;if(!e.loaded){c=false;this._ajaxGetTab({tabModel:e,data:{TabId:e.tabId}})}if(e.html){e.container.find(this.options.tabContentSelector).html(e.html)}if(!e.pager){e.pager=e.container.find(this.options.pagerSelector);e.pager.bsPager({pagerUpdate:function(g,f){d._evChangePage(f,e)},pagerGoTop:$.proxy(this._evGoTop,this)})}e.container.show();if(c){this._checkItems()}}};a.prototype._evUp=function(f){f.preventDefault();var c=$(f.currentTarget).parents(this.options.groupItemSelector).first(),d=c.prevAll(this.options.groupItemSelector).first();if(d.length>0){d.before(c);this._rebuildNumbers()}else{this._shakeElement(c)}};a.prototype._evDown=function(f){f.preventDefault();var c=$(f.currentTarget).parents(this.options.groupItemSelector).first(),d=c.nextAll(this.options.groupItemSelector).first();if(d.length>0){d.after(c);this._rebuildNumbers()}else{this._shakeElement(c)}};a.prototype._evToggleExpand=function(g){g.preventDefault();var d=$(g.currentTarget),f=d.parents("[data-groupid]"),c=f.find(this.options.groupItemsWrapper);c.toggle("fast",$.proxy(function(){f.find(this.options.toggleExpandBtn).toggleClass("open")},this))};a.prototype._evChangeToolbarForm=function(f){f.preventDefault();var d=$(f.currentTarget),h=d.data("uid"),g=this._getSelectedTab(),c=g.container,i=c.find("div[data-uid]:visible"),j=i.data("uid");i.slideUp();if(j!=h){c.find("div[data-uid='"+h+"']").slideDown()}};a.prototype._evChangeTab=function(f){f.preventDefault();var d=$(f.currentTarget),h=d.data("tabid"),c=this._getTab(h),g=this._isLoaded(c);this._hideTabs();this._initTab({container:c,loaded:g,tabId:h})};a.prototype._evChangePage=function(c,d){this._ajaxGetTab({tabModel:d,data:{Page:c.page,PageSize:c.pageSize||5,TabId:d.tabId}})};a.prototype._evGoTop=function(c){c.preventDefault();console.log(" -- go to top --",arguments)};a.prototype._evRemove=function(f){f.preventDefault();var c=$(f.currentTarget),d=c.parents(this.options.groupItemSelector),h=d.data("tabid"),g=d.data("objid");d.remove();this._toggleItemCheck(this._getTabItem(h,g),true);this._countGroupItems()};a.prototype._evAdd=function(g){g.preventDefault();var c=$(g.currentTarget),h=c.parents(this.options.tabItemSelector).data("objid"),j=this._getSelectedTab(),i=j.tabId,f=j.connectsWith,d=this._getGroups(f);d.each($.proxy(function(l,k){if(!this._isInGroup(h,i,$(k))){var e=this._getGroupItemTemplate($(k),i,h),n=this._getTabItem(i,h),m=n.data("model");var o=this.renderer["js-groupItem"](m);e.find(this.options.groupItemContentSelector).html(o);this._checkEditableItem(e);$(k).find(this.options.groupItemsWrapper).append(e);this._checkItem(this._getTabItem(i,h),i,f);return false}},this));this._countGroupItems()};a.prototype._evEdit=function(f){f.preventDefault();var c=$(f.currentTarget),d=c.parents(this.options.groupItemSelector),h=d.data("objid"),i=d.data("tabid"),g=d.parents("[data-groupid]").data("groupid");throw"[objId: "+h+", groupId: "+g+", tabId: "+i+"] . not implemented yet"};a.prototype._ajaxGetTab=function(d){var c={name:this.options.uniqueName+"|getTab",url:this.options.getTabUrl,data:d.data,callbackData:d,context:this,success:$.proxy(this._ajaxGetTabSuccess,this),error:$.proxy(this._ajaxGetTabError,this),loadingElement:d.tabModel.container,loadingClass:"loading"};$.bforms.ajax(c)};a.prototype._ajaxGetTabSuccess=function(e,c){if(e){var d=c.tabModel.container;d.data("loaded","true");if(e.Html){this._initTab({container:d,loaded:true,html:e.Html,tabId:c.tabModel.tabId})}}};a.prototype._ajaxGetTabError=function(){console.trace()};a.prototype._checkEditable=function(){$.each(this._getGroupItems(),$.proxy(function(c,d){this._checkEditableItem($(d))},this))};a.prototype._checkEditableItem=function(c){if(this._isTabEditable(c.data("tabid"))){c.find(this.options.editBtn).show()}};a.prototype._rebuildNumbers=function(){};a.prototype._shakeElement=function(c){c.effect("shake",{times:2,direction:"up",distance:10},50)};a.prototype._countGroupItems=function(){this.$counter.html(this._getGroupItems().length)};a.prototype._checkItem=function(c,e,d){if(this._isItemSelected(c.data("objid"),e,d)){this._toggleItemCheck(c,false)}};a.prototype._checkItems=function(){var d=this._getSelectedTab(),c=d.container.find(this.options.tabItemSelector);$.each(c,$.proxy(function(e,f){this._checkItem($(f),d.tabId,d.connectsWith)},this))};a.prototype._isItemSelected=function(e,g,d){var c=this._getGroups(d),f=true;$.each(c,$.proxy(function(i,h){if(!this._isInGroup(e,g,$(h))){f=false}},this));return f};a.prototype._isInGroup=function(f,g,c){var e=false,d=c.find(this.options.groupItemSelector);$.each(d,function(h,i){if($(i).data("objid")==f&&$(i).data("tabid")==g){e=true;return false}});return e};a.prototype._toggleItemCheck=function(d,f){var c=d.find("span.glyphicon"),e=this.options.addBtn.replace(".","");if(f&&!d.hasClass("selected")){return false}if(!f&&d.hasClass("selected")){return false}d.toggleClass("selected");c.parents("a:first").toggleClass(e);if(c.hasClass("glyphicon-ok")){c.removeClass("glyphicon-ok").addClass("glyphicon-plus")}else{c.removeClass("glyphicon-plus").addClass("glyphicon-ok")}};a.prototype._getSelectedTab=function(){var c=this.$tabs.find("div[data-tabid]:visible"),f=c.data("tabid"),d=c.data("connectswith"),e=this._isLoaded(c);return{container:c,tabId:f,connectsWith:d,loaded:e}};a.prototype._hideTabs=function(){var c=this.$tabs.find("div[data-tabid]");c.hide()};a.prototype._isLoaded=function(c){var d=c.data("loaded");return d=="true"||d=="True"||d==true};a.prototype._getTab=function(c){return this.$tabs.find('div[data-tabid="'+c+'"]')};a.prototype._isTabEditable=function(c){return this._getTab(c).data("editable")};a.prototype._getTabItem=function(f,e){var c=this._getTab(f),d=c.find(this.options.tabItemSelector+'[data-objid="'+e+'"]');return d};a.prototype._getGroup=function(c){return this.$groups.find('div[data-groupid="'+c+'"]')};a.prototype._getGroupItems=function(){return this.$groups.find(this.options.groupItemSelector+":not("+this.options.groupItemTemplateSelector+" >)")};a.prototype._getGroups=function(d){var c;if(d){c=[];$.each(d,$.proxy(function(f,e){c.unshift(this._getGroup(e))},this))}else{c=this.$groups.find("div[data-groupid]")}return c};a.prototype._getGroupItemTemplate=function(c,f,e){var g=c.find(this.options.groupItemTemplateSelector).children(":first").clone();g.data("objid",e);g.data("tabid",f);var d=g.html();d=d.replace(/__tabid__/gi,f);d=d.replace(/{{tabid}}/gi,f);d=d.replace(/__objid__/gi,f);d=d.replace(/{{objid}}/gi,e);g.html(d);return g};$.widget("bforms.bsGroupEditor",a.prototype);return a});(function(a){if(typeof define==="function"&&define.amd){define("bforms-themeSelect",["jquery","jquery-ui-core","amplify"],a)}else{a(window.jQuery)}}(function(a){var b=requireConfig.websiteOptions;String.prototype.toUpperCaseFirst=function(){return this.charAt(0).toUpperCase()+this.slice(1)};var c=function(){};c.prototype.options={targets:"body, .form_container, .grid_toolbar, .grid_view, .bs-datetime-picker, .bs-range-picker, .bs-pager",startTheme:b.startTheme,themeEnum:b.themeEnum,availableColors:"turqoise orange green blue purple black",toggleSelector:".bs-toggleThemeSelect",openSelector:".bs-selectThemeOpen",closeSelector:".bs-selectThemeClose",defaultTheme:"turqoise",optionsSelector:".bs-selectThemeOptions",localStorageSave:false,ajaxSaveUrl:b.saveThemeUrl};c.prototype._init=function(){this.$element=this.element;this._currentColor=this.options.startTheme||"Default";if(this._currentColor=="Default"){this._isDefaultSelected=true}this._currentColorClass=this._currentColor.toLowerCase();this._isOpen=this.$element.find(this.options.closeSelector).is(":visible");if(this._isDefaultSelected){this.$element.find('*[data-isdefault="true"]').parent().hide()}this._addDelegates();this._restoreState()};c.prototype._addDelegates=function(){this.$element.on("click",this.options.optionsSelector+" a",a.proxy(this._onColorSelect,this));this.$element.on("click",this.options.toggleSelector,a.proxy(this._onToggleClick,this))};c.prototype._onColorSelect=function(f){f.preventDefault();var d=a(f.currentTarget);if(d.data("isdefault")){this._isDefaultSelected=true}else{this._isDefaultSelected=false}var g=d.data("color");this.setColor(g)};c.prototype._onToggleClick=function(d){d.preventDefault();if(this._isOpen){this.close()}else{this.open()}};c.prototype.setColor=function(d){try{a(this.options.targets).removeClass(this.options.availableColors);a(this.options.targets).removeClass(d);a(this.options.targets).addClass(d);this._currentColor=d;this._currentColorClass=d;if(this._isDefaultSelected){this.$element.find('*[data-isdefault="true"]').parent().hide()}else{this.$element.find('*[data-isdefault="true"]').parent().show()}}catch(f){throw"Invalid targets for themeSelect"}this._saveState()};c.prototype.getCurrentColorClass=function(){return this._currentColorClass};c.prototype.open=function(){this.element.find(this.options.openSelector).hide();this.element.find(this.options.closeSelector).show();this.element.removeClass("collapsed");this._isOpen=true};c.prototype.close=function(){this.element.find(this.options.closeSelector).hide();this.element.find(this.options.openSelector).show();this.element.addClass("collapsed");this._isOpen=false};c.prototype._saveState=function(){if(this.options.localStorageSave){var d={Theme:this._currentColor.toUpperCaseFirst(),Open:this._isOpen};amplify.store("themeSelect",d)}if(this.options.ajaxSaveUrl!=null){a.ajax({url:this.options.ajaxSaveUrl,data:{Theme:this._isDefaultSelected?"Default":this.options.themeEnum[this._currentColor.toUpperCaseFirst()],Open:this._isOpen,},type:"POST"})}};c.prototype._restoreState=function(){if(this.options.localStorageSave===true){var e=amplify.store("themeSelect");if(typeof e!=="undefined"&&e!=null){if(e.Theme){var d=e.Theme.toLowerCase();this.setColor(d)}if(e.open){this.open()}}}};a.widget("bforms.bsThemeSelect",c.prototype);return c}));(function(a){if(typeof define==="function"&&define.amd){define("bforms-panel",["jquery","bootstrap","amplify","bforms-ajax","bforms-form"],a)}else{a(window.jQuery)}})(function(a){var b=function(){};b.prototype.options={collapse:true,loaded:false,editable:true,toggleSelector:".bs-togglePanel",editSelector:".bs-editPanel",cancelEditSelector:".bs-cancelEdit",saveFormSelector:".bs-savePanel",containerSelector:".bs-containerPanel",contentSelector:".bs-contentPanel",retrySelector:".bs-retryBtn",headerToggle:false,headerSelector:".bs-panelHeader",cacheReadonlyContent:true,additionalData:{},formOptions:{}};b.prototype._init=function(){this.$element=this.element;this.$element.addClass("bs-hasPanel");this._loadOptions();this._initDefaultProperties();this._initSelectors();this._delegateEvents();if(this.options.loaded===true){this._initControls();this._loadState();this._initCurrentContent()}else{var c=this._readonly?"_loadReadonlyContent":"_loadEditableContent";this[c]().then(a.proxy(function(){this._initControls();this._loadState();this._initCurrentContent()},this))}};b.prototype._loadOptions=function(){var c=this.$element.data("settings");a.extend(true,this.options,c)};b.prototype._initDefaultProperties=function(){this._name=this.options.name||this.$element.prop("id");if(typeof this._name==="undefined"||this._name==""){throw"boxForm requires an unique name"}this._componentId=this.$element.data("component");if(typeof this._componentId==="undefined"){console.warn("No component id specified for "+this._name)}this._objId=this.$element.data("objid");this._key=window.location.pathname+"|BoxForm|"+this._name;if((typeof this.options.initialReadonly==="undefined"||this.options.initialReadonly==true)&&this.$element.data("readonly")!==false){this.showReadonly()}else{this.showEditable()}this.options.readonlyUrl=this.options.readonlyUrl||this.$element.data("readonlyurl");this.options.editableUrl=this.options.editableUrl||this.$element.data("editableurl");this.options.saveUrl=this.options.saveUrl||this.$element.data("saveurl");this._allowExpand=this.options.loaded};b.prototype._initSelectors=function(){this.$container=this.$element.find(this.options.containerSelector);this.$content=this.$element.find(this.options.contentSelector)};b.prototype._delegateEvents=function(){this.$element.on("click",this.options.toggleSelector,a.proxy(this._onToggleClick,this));if(this.options.headerToggle){this.$element.on("click",this.options.headerSelector,a.proxy(this._onHeaderClick,this))}else{this.$element.on("click",this.options.editSelector,a.proxy(this._onEditClick,this))}this.$element.on("click",this.options.cancelEditSelector,a.proxy(this._onCancelEditClick,this));this.$element.on("click",this.options.retrySelector,a.proxy(this._onRetryClick,this))};b.prototype._initCurrentContent=function(){if(this._readonly){}else{this._initEditable()}};b.prototype._onToggleClick=function(c){c.preventDefault();c.stopPropagation();if(this._allowExpand){if(this._state){this.close()}else{this.open()}}};b.prototype._onHeaderClick=function(c){if(this._readonly==true){this._loadEditableContent().then(a.proxy(function(){if(!this._state&&this._allowExpand){this.open()}},this));c.preventDefault();c.stopPropagation()}};b.prototype._onEditClick=function(c){c.preventDefault();c.stopPropagation();this._loadEditableContent().then(a.proxy(function(){if(!this._state&&this._allowExpand){this.open()}},this))};b.prototype._onCancelEditClick=function(c){c.preventDefault();c.stopPropagation();if(this.options.cacheReadonlyContent&&this._cachedReadonlyContent){this.$content.html(this._cachedReadonlyContent);this.showReadonly();this._toggleEditBtn(true);if(!this._state){this.open()}}else{this._loadReadonlyContent().then(a.proxy(function(){this._toggleEditBtn(true);if(!this._state){this.open()}},this))}};b.prototype._onRetryClick=function(d){var c=a(d.currentTarget),f=c.data("method");if(typeof this[f]==="function"){this[f]()}};b.prototype._saveState=function(){amplify.store(this._key,this._state)};b.prototype._loadState=function(){var c=amplify.store(this._key);if(c!=null){if(c==true){this.open()}else{this.close()}}};b.prototype._initControls=function(){if(this.options.editable){this._toggleEditBtn(this._readonly?true:false)}};b.prototype._toggleLoading=function(c){if(c){this.$element.find(".bs-panelLoader").show()}else{this.$element.find(".bs-panelLoader").hide()}};b.prototype._toggleCaret=function(c){if(c){this.$element.find(".bs-panelCaret").show()}else{this.$element.find(".bs-panelCaret").hide()}};b.prototype._toggleEditBtn=function(c){if(c){this.$element.find(this.options.cancelEditSelector).hide().end().find(this.options.editSelector).show()}else{this.$element.find(this.options.editSelector).hide().end().find(this.options.cancelEditSelector).show()}};b.prototype._getXhrData=function(){return a.extend(true,{},{componentId:this._componentId,objId:this._objId},this.options.additionalData)};b.prototype._showErrorMessage=function(e,d,g,f){var c=a('<div class="bs-form-error alert alert-danger"><button class="close" data-dismiss="alert" type="button">×</button>'+e+'<div><a href="#" class="bs-retryBtn" data-method="'+f+'">Retry <span class="glyphicon glyphicon-refresh"></span> </a></div></div>');if(g){d.html(c)}else{d.append(c)}};b.prototype._initEditable=function(){var c=this.$content.find("form").show(),d=c.find(this.options.saveFormSelector);this._allowExpand=true;if(c.length==0){console.warn("No editable form found")}if(d.length==0){console.warn("No save button found")}var e=a.extend(true,{},{prefix:this.options.prefix,actions:[{name:"save",selector:this.options.saveFormSelector,validate:true,actionUrl:this.options.saveUrl,parse:true,getExtraData:a.proxy(function(f){f.componentId=this._componentId;f.objId=this._objId;a.extend(true,f,this.options.formAdditionalData);this._trigger("beforeSaveAjax",0,f)},this),handler:a.proxy(function(g,f){this._trigger("beforeEditSuccessHandler",0,f);this.$content.html(f.Html);this._toggleLoading();this._toggleEditBtn(true);if(this.options.cacheReadonlyContent){this._cachedReadonlyContent=this.$content.html()}this.showReadonly();this._trigger("editSuccessHandler",0,f)},this)}]},this.options.formOptions);this.$content.find("form").bsForm(e);this._trigger("afterFormInit",0)};b.prototype._loadReadonlyContent=function(){var c=this._getXhrData();this._trigger("beforeReadonlyLoad",c);this.$content.find("form").addClass("loading");return a.bforms.ajax({name:"BsPanel|LoadReadonly|"+this._name,url:this.options.readonlyUrl,data:c,context:this,success:this._onReadonlyLoadSuccess,error:this._onReadonlyLoadError})};b.prototype._onReadonlyLoadSuccess=function(c){this.$content.html(c.Html);this._toggleLoading();this._toggleCaret(true);this._allowExpand=true;if(this.options.cacheReadonlyContent){this._cachedReadonlyContent=this.$content.html()}this._trigger("onReadonlyLoadSuccess",0,c);this.showReadonly()};b.prototype._onReadonlyLoadError=function(d){this.$content.find("form").removeClass("loading");if(d.Message){var c=this.$element.find(".bs-panel_validation");if(c.length==0){c=a('<div class="col-12 col-sm-12 col-lg-12 bs-validation_row_control"></div>');this.$container.before(c)}this._toggleLoading();this._showErrorMessage(d.Message,c,true,"_loadReadonlyContent")}};b.prototype._loadEditableContent=function(){var c=this._getXhrData();this._trigger("beforeEditableLoad",c);this.$content.find("form").addClass("loading");return a.bforms.ajax({name:"BsPanel|LoadEditable|"+this._name,url:this.options.editableUrl,context:this,data:c,success:this._onEditableLoadSuccess,error:this._onEditableLoadError})};b.prototype._onEditableLoadSuccess=function(c){if(this.options.cacheReadonlyContent){this._cachedReadonlyContent=this.$content.clone().find("form").removeClass("loading").end().html()}this.$content.html(c.Html);this._initEditable();this._toggleEditBtn();this._toggleLoading();this._toggleCaret(true);this._trigger("onEditableLoadSuccess",0,c);this.showEditable()};b.prototype._onEditableLoadError=function(){this.$content.find("form").removeClass("loading")};b.prototype.open=function(){var c={allowOpen:true,$content:this.$content};this._trigger("beforeOpen",c);if(c.allowOpen===true){this.$container.stop(true,true).slideDown(300);this.$element.find(this.options.toggleSelector).addClass("dropup")}this._state=true;this._saveState();this._trigger("afterOpen")};b.prototype.close=function(){var c={allowClose:true,$content:this.$content};this._trigger("beforeClose",c);if(c.allowClose===true){this.$container.stop(true,true).slideUp(300);this.$element.find(this.options.toggleSelector).removeClass("dropup")}this._state=false;this._saveState();this._trigger("afterClose")};b.prototype.showReadonly=function(){this._readonly=true;this.$element.data("readonly",true);this.$element.removeClass("bs-panelEditMode");this._trigger("onReadonlyShow",0)};b.prototype.showEditable=function(){this._readonly=false;this.$element.data("readonly",false);this.$element.addClass("bs-panelEditMode");this._trigger("onEditableShow",0)};a.widget("bforms.bsPanel",b.prototype);return b});define("bforms-ajax",["bforms-namespace","jquery"],function(){var a=function(){this._xhrStack={}};a.prototype._defOptions={cache:false,type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",context:null,registerGlobal:true,killPrevious:true,loadingDelay:100};a.prototype._getStack=function(){return this._xhrStack};a.prototype._statusEnum={Success:1,ValidationError:2,Denied:3,ServerError:4};a.prototype.getAjaxOptions=function(){return $.extend(true,{},this._defOptions)};a.prototype._updateXHRSettings=function(b){var c=$.extend(true,{},b);c.data=b.contentType===this._defOptions.contentType?JSON.stringify(this._serializeJsonData(b.data)):b.data;return c};a.prototype._serializeJsonData=function(b){var d;if(b instanceof Array){d=b.slice(0)}else{d=$.extend(true,{},b)}for(var c in d){if(d.hasOwnProperty(c)){if(typeof d[c]==="number"){d[c]+=""}else{if(typeof d[c]==="object"){d[c]=this._serializeJsonData(d[c])}}}}return d};a.prototype._killPrevious=function(b){var c=this._xhrStack[b];if(typeof c!=="undefined"&&c!=null&&c.jqXHR!=null&&typeof c.jqXHR.abort==="function"&&c.finished!==true){c.aborted=true;c.finished=true;c.jqXHR.abort();this._xhrStack[b]=c;this._toggleLoading(c,true)}};a.prototype._toggleLoading=function(f,e){var c=typeof f==="string"?this._xhrStack[f]:f,d=(typeof c!=="undefined"&&c.settings.loadingClass!=="undefined")?c.settings.loadingClass:this._defaultLoadingClass;if(typeof c!=="undefined"&&typeof c.settings!=="undefined"){var b=c.settings.loadingElement;if(b!=null&&b.length){window.clearTimeout(this.loadingTimeout);if(e){this.loadingTimeout=window.setTimeout(function(){d==null?b.show():b.addClass(d)},c.settings.loadingDelay)}else{d==null?b.hide():b.removeClass(d)}}}};a.prototype.ajax=function(f,b){var h=false;if(typeof File!=="undefined"){for(var e in f.data){if(f.data.hasOwnProperty(e)){if(f.data[e] instanceof File){h=true;break}}}}var i=$.extend({},this.getDefaultOptions(),f),d=null;i.name=i.name||i.url;if(i.killPrevious===true){this._killPrevious(i.name)}var c=$.Deferred();c.done($.proxy(function(k,j){if(k===this._statusEnum.Success){if(typeof f.success==="function"){f.success.apply(f.context,j)}}else{if(k===this._statusEnum.ValidationError){if(typeof f.validationError==="function"){f.validationError.apply(f.context,j)}if(typeof f.error==="function"){f.error.apply(f.context,j)}}}if(k===this._statusEnum.ServerError){if(typeof f.serverError==="function"){f.serverError.apply(f.context,j)}if(typeof f.error==="function"){f.error.apply(f.context,j)}}if(k===this._statusEnum.Denied){if(typeof f.denied==="function"){f.denied.apply(f.context,j)}if(typeof f.error==="function"){f.error.apply(f.context,j)}}},this));c.fail($.proxy(function(k,j){if(k===this._statusEnum.ServerError){if(typeof f.serverError==="function"){f.serverError.apply(f.context,j)}}else{if(k===this._statusEnum.Denied){if(typeof f.denied==="function"){f.denied.apply(f.context,j)}}}if(typeof f.error==="function"){f.error.apply(f.context,j)}},this));if(typeof f.complete==="function"){c.always($.proxy(f.complete,f.context))}if(typeof f.progress==="function"){c.progress($.proxy(f.progress,f.context))}if(h){d=this._ajaxWithFiles(i,b,c)}else{d=this._ajaxWithoutFiles(i,b,c)}var g=c.promise();g.abort=d.abort;g.success=c.done;g.error=c.fail;this._toggleLoading(i.name,true);if(typeof b!=="undefined"&&b!=null){b.deferred=c}return g};a.prototype._ajaxWithoutFiles=function(h,c,d){var f=this;var e=$.extend({},h,{success:function(k,l,j){var m=f._xhrStack[h.name];if(m.aborted===true){return}try{if(k.Status==f._statusEnum.Success||k.Status==f._statusEnum.ValidationError){d.resolve(k.Status,[k.Data,h.callbackData])}else{d.reject(k.Status,[k,j,l,null,h.callbackData])}}catch(i){if(typeof i.stack!=="undefined"){console.warn("Exception occurred in ajax request");console.log(i.stack)}else{console.warn("Exception occurred in ajax request: "+i)}}},error:function(k,m,i){var n=f._xhrStack[h.name];if(typeof n!=="undefined"&&n!=null&&n.aborted===true){return}try{if(typeof k.responseText!=="undefined"){var l=JSON.parse(k.responseText);d.reject(l.Status,[l,k,m,i,h.callbackData])}else{d.reject(f._statusEnum.ServerError,[{Message:i},k,m,i,h.callbackData])}}catch(j){window.console.log(j.stack)}},complete:function(){var i=f._xhrStack[h.name];if(typeof i!=="undefined"){i.finished=true}f._toggleLoading(h.name,false)}});var b=this._updateXHRSettings(e);var g=this._xhrStack[h.name]={jqXHR:$.ajax(b),aborted:false,settings:h};return g.jqXHR};a.prototype._ajaxWithFiles=function(f,b,d){var h=new XMLHttpRequest(),c=new FormData(),g=this;for(var e in f.data){if(f.data.hasOwnProperty(e)){c.append(e,f.data[e])}}f.contentType="";$.extend(true,h,$.extend(true,{},this.getDefaultOptions(),f));h.upload.addEventListener("progress",$.proxy(function(i){i.progress=i.progress/i.total;d.notifyWith(i,f.callbackData)},this));h.onreadystatechange=$.proxy(function(i){var k=this._xhrStack[h.name];if(h.readyState===4&&k.aborted!==true){var j=JSON.parse(h.responseText);if(j.Status==g._statusEnum.Success||j.Status==g._statusEnum.ValidationError){d.resolve(j.Status,[j,f.callbackData])}else{d.reject(j.Status,[j!=null?null:j.Data,jqXHR,textStatus,errorThrown,f.callbackData])}g._toggleLoading(f.name,false)}},this);h.open("POST",f.url,true);h.send(c);this._xhrStack[f.name]={jqXHR:h,aborted:false,settings:f};return this._xhrStack[f.name].jqXHR};a.prototype.getDefaultOptions=function(){return $.extend(true,{},this._defOptions)};a.prototype.abort=function(b){var c=this._xhrStack[b];if(typeof c!=="undefined"&&c!=null&&c.jqXHR!=null){c.jqXHR.abort();c.aborted=true}};$.extend(true,$.bforms,new a());return a});/*
 * BForms v1.0.0 Alpha
 * http://bforms.stefanprodan.eu
 *
 * Copyright 2013 Stefan Prodan and contributors
 * http://github.com/stefanprodan/BForms/contributors
 * Licensed under the MIT license
 */
define("bforms-namespace",["jquery","jquery-migrate"],function(a){a.nsx=function(d){var f=d.split("."),e=a,c;if(f[0]==="$"){f=f.slice(1)}else{if(f[0]==="jQuery"){f=f.slice(1)}}for(c=0;c<f.length;c+=1){if(typeof e[f[c]]==="undefined"){e[f[c]]={}}e=e[f[c]]}return e};a.nsx("bforms");var b=function(){};b.prototype.scrollToElement=function(e){var c=$(e);if(c.length>0){var h=a.bforms.getViewport();var g=$(e).offset().top;var f=h.height/2;var d=g;if(f<g){d=g-f}else{d=0}if($.browser.msie&&$.browser.mobile){$("html").scrollTop(d)}else{$("html,body").animate({scrollTop:d},500)}}};b.prototype.getViewport=function(){var i=window,c=document,f=c.documentElement,h=c.getElementsByTagName("body")[0],j=i.innerWidth||f.clientWidth||h.clientWidth,k=i.innerHeight||f.clientHeight||h.clientHeight;return{width:j,height:k}};b.prototype.param=function(c,g){var e,f=[],d=function(h,i){i=a.isFunction(i)?i():(i==null?"":i);f[f.length]=encodeURIComponent(h)+"="+encodeURIComponent(i)};if(g===undefined){g=a.ajaxSettings&&a.ajaxSettings.traditional}if(a.isArray(c)||(c.jquery&&!a.isPlainObject(c))){a.each(c,function(){d(this.name,this.value)})}else{for(e in c){this.buildParams(e,c[e],g,d)}}return f.join("&").replace("/%20/g","+")};b.prototype.buildParams=function(f,e,g,c){var d;if(a.isArray(e)){a.each(e,$.proxy(function(h,j){if(g||/\[\]$/.test(f)){c(f,j)}else{this.buildParams(f+"["+h+"]",j,g,c)}},this))}else{if(!g&&a.type(e)==="object"){for(d in e){this.buildParams(f+"."+d,e[d],g,c)}}else{c(f,e)}}};$.extend(true,$.bforms,new b());return b});